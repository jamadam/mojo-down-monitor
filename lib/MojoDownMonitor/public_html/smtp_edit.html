<% extends(&SitesBase::is_pjax() ? '/base_pjax.html' : '/base.html')<<EXTENDS %>
	<% block('doctitle')<<BLOCK %>
	<title>Edit SMTP info | mojo-down-monitor</title>
	<% BLOCK %>
	<% block('main')<<BLOCK %>
	<div id="mainLevel2">
		
		<% if(&Sites::user_err()->count)<<USERERR %>
			<ul id="formErrorContainer">
				<% Sites::user_err()->each('value')<<LI %>
					<li>
						<% $value %>
					</li>
				<% LI %>
			</ul>
		<% USERERR %>
		
		<% SMTP::loop(
			assign 	=> 'smtp',
			where 	=> {id => 1},
			fields 	=> [
				'host',
				'port',
				'ssl',
				'user',
				'password',
			]
		)<<EOF %>
			<h2>
				Edit SMTP
			</h2>
			
			<form enctype="multipart/form-data" method="post" action="./smtp_edit.html">
			<div>
				<input type="hidden" name="nextpage" value="/smtp_edit.html" />
				<input type="hidden" name="mode" value="update" />
				<input type="hidden" name="where" value='{"id":"1"}' />
				<input type="hidden" name="columns" value="host,port,ssl,user,password" />
			</div>
			<table>
				<tfoot>
					<tr>
						<td></td>
						<td>
							<input type="submit" value="edit" class="button" />
						</td>
					</tr>
				</tfoot>
				<tbody>
				<% $smtp->each('column')<<EOF2 %>
					<tr>
						<th>
							<%= $column->key %>
						</th>
						<td>
							<% switch($column->key, ['password'])<<CASE1,DEFAULT %>
								<% include('./form_parts/password.html', {column => $column}) %>
							<% CASE1 %>
								<% include('./form_parts/'. lc $column->type. '.html', {column => $column}) %>
							<% DEFAULT %>
						</td>
					</tr>
				<% EOF2 %>
				</tbody>
			</table>
			</form>
		<% EOF %>
	</div>
	<% BLOCK %>
<% EXTENDS %>
