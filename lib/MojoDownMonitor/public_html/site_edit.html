<% assign(site => &Sites::load(
	where 	=> {id => &param('a')},
	fields 	=> [
		'id',
		'Site name',
		'URI',
		'Interval',
		'Mail to',
		'Status must be',
		'MIME type must be',
		'Content must match',
		'HTTP header must match',
		'Body size must be',
		'Max log',
		'Connect timeout',
		'User Agent',
	]
)) %>
<% extends(&SitesBase::is_pjax() ? '/base_pjax.html' : '/base.html')<<EXTENDS %>
	<% block('doctitle')<<BLOCK %>
	<title>Edit <%= $site->value('Site name') %> | mojo-down-monitor</title>
	<% BLOCK %>
	<% block('main')<<BLOCK %>
	<h2>
		<%= $site->value('Site name') %>
	</h2>
	
	<div class="tabStyleMenu">
		<a href="/site_log.html?a=<%= param('a') %>">log</a>
		<a href="/site_edit.html?a=<%= param('a') %>">Site Edit</a>
	</div>
	<div id="mainLevel2">
		
		<% if(&Sites::user_err()->count)<<USERERR %>
			<ul id="formErrorContainer">
				<% Sites::user_err()->each('value')<<LI %>
					<li>
						<%= $value %>
					</li>
				<% LI %>
			</ul>
		<% USERERR %>
		
		<form enctype="multipart/form-data" method="post" action="./site_edit.html?a=<%= param('a') %>">
		<div>
			<input type="hidden" name="nextpage" value="/site_edit.html?a=<%= param('a') %>" />
			<input type="hidden" name="mode" value="update" />
			<input type="hidden" name="where" value='{"id":<%= param('a') %>}' />
			<input type="hidden" name="columns" value="Site name,URI,Interval,Mail to,Status must be,MIME type must be,Content must match,HTTP header must match,Body size must be,Max log,Connect timeout,User Agent" />
		</div>
		<table>
			<tfoot>
				<tr>
					<td></td>
					<td>
						<input type="submit" value="edit" class="button" />
						<input type="button" value="test connection" class="button siteTest" />
					</td>
				</tr>
			</tfoot>
			<tbody>
				<% $site->each('column')<<EOF2 %>
					<tr>
						<th>
							<%= $column->key %>
						</th>
						<td>
							<% switch($column->key, ['id'])<<CASE1,DEFAULT %>
								<% include('./form_parts/readonly_varchar.html', {column => $column}) %>
							<% CASE1 %>
								<% include('./form_parts/'. lc $column->type. '.html', {column => $column}) %>
							<% DEFAULT %>
						</td>
					</tr>
				<% EOF2 %>
			</tbody>
		</table>
		</form>
	</div>
	<% BLOCK %>
<% EXTENDS %>
